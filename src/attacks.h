#pragma once

#include "board.h"

#include <stdint.h>


struct Magic {
	uint64_t magic;
	uint64_t mask;
	uint64_t *table;
};

static const uint64_t KNIGHT_ATTACKS[64] = {
	0x20400, 0x50800, 0xa1100, 0x142200, 0x284400, 0x508800, 0xa01000, 0x402000, 
	0x2040004, 0x5080008, 0xa110011, 0x14220022, 0x28440044, 0x50880088, 0xa0100010, 0x40200020, 
	0x204000402, 0x508000805, 0xa1100110a, 0x1422002214, 0x2844004428, 0x5088008850, 0xa0100010a0, 0x4020002040, 
	0x20400040200, 0x50800080500, 0xa1100110a00, 0x142200221400, 0x284400442800, 0x508800885000, 0xa0100010a000, 0x402000204000, 
	0x2040004020000, 0x5080008050000, 0xa1100110a0000, 0x14220022140000, 0x28440044280000, 0x50880088500000, 0xa0100010a00000, 0x40200020400000, 
	0x204000402000000, 0x508000805000000, 0xa1100110a000000, 0x1422002214000000, 0x2844004428000000, 0x5088008850000000, 0xa0100010a0000000, 0x4020002040000000, 
	0x400040200000000, 0x800080500000000, 0x1100110a00000000, 0x2200221400000000, 0x4400442800000000, 0x8800885000000000, 0x100010a000000000, 0x2000204000000000, 
	0x4020000000000, 0x8050000000000, 0x110a0000000000, 0x22140000000000, 0x44280000000000, 0x88500000000000, 0x10a00000000000, 0x20400000000000};

static const uint64_t KING_ATTACKS[64] = {
	0x0000000000000302, 0x0000000000000705, 0x000000000000e0a, 0x0000000000001c14, 0x0000000000003828, 0x7050, 0xe0a0, 0xc040, 
	0x30203, 0x70507, 0xe0a0e, 0x1c141c, 0x382838, 0x705070, 0xe0a0e0, 0xc040c0, 
	0x3020300, 0x7050700, 0xe0a0e00, 0x1c141c00, 0x38283800, 0x70507000, 0xe0a0e000, 0xc040c000, 
	0x302030000, 0x705070000, 0xe0a0e0000, 0x1c141c0000, 0x3828380000, 0x7050700000, 0xe0a0e00000, 0xc040c00000, 
	0x30203000000, 0x70507000000, 0xe0a0e000000, 0x1c141c000000, 0x382838000000, 0x705070000000, 0xe0a0e0000000, 0xc040c0000000, 
	0x3020300000000, 0x7050700000000, 0xe0a0e00000000, 0x1c141c00000000, 0x38283800000000, 0x70507000000000, 0xe0a0e000000000, 0xc040c000000000, 
	0x302030000000000, 0x705070000000000, 0xe0a0e0000000000, 0x1c141c0000000000, 0x3828380000000000, 0x7050700000000000, 0xe0a0e00000000000, 0xc040c00000000000, 
	0x203000000000000, 0x507000000000000, 0xa0e000000000000, 0x141c000000000000, 0x2838000000000000, 0x5070000000000000, 0xa0e0000000000000, 0x40c0000000000000};

static const uint64_t ROOK_MAGICS[64] = {0x80081432008800ull, 0x140011002404500ull, 0x11040020100c1280ull, 0xa10001004804120ull, 0x1004000040342880ull, 0x1004000082041140ull, 0x401008040010028ull, 0xa001000005b00220ull, 
0x210020080080ull, 0x24020100400ull, 0x2020001085002c0ull, 0x860002406c0006c0ull, 0x24010104000200ull, 0x60108300888ull, 0x5450010000080420ull, 0x24040240a0281220ull, 
0x441000423000ull, 0x40010020001000ull, 0x1110160200381400ull, 0x1000200c00040250ull, 0x80020100420ull, 0x4000042800140008ull, 0x1010014004302820ull, 0x8a00a24000104480ull, 
0x2840009612000400ull, 0x12640304000ull, 0x422028030002100ull, 0x400304004080ull, 0x2000084080010280ull, 0x15a34000020ull, 0x400018104000810ull, 0x2014a840c0100ull, 
0x80400a1400020200ull, 0x84000220042ull, 0x410040040a440080ull, 0x4000021402041800ull, 0x54010010070ull, 0xc01200080120008ull, 0x8000001112420090ull, 0x848000624d00ull, 
0x40104404800ull, 0x104201c0040ull, 0x220000c80200ull, 0x2000100020024400ull, 0x4000002540008420ull, 0x2000042002021400ull, 0x1409008200ull, 0x8001004290ull, 
0x800882201006ull, 0x8000044248002020ull, 0x8512c14500a00ull, 0x4408010060222200ull, 0x408114c060ull, 0xa001011e1910840ull, 0xc000002004d00a20ull, 0x2040024011100402ull, 
0x88004a04002ull, 0x142801104012ull, 0x1204010002008811ull, 0x180111a004100246ull, 0x1300501086c4082ull, 0x101040488c81802ull, 0x2000000900204012ull, 0x480c02229ull};


bool isSquareAttacked(Board board, bool turn, int square);
uint64_t slidingAttacks(Board *board, bool turn, int square, uint64_t mask);
uint64_t slidingAttacks(uint64_t occupied, int square, uint64_t mask);
uint64_t getAttacks(Board board, bool turn);
uint64_t pawnAttacks(Board *board, bool turn);
uint64_t knightAttacks(Board *board, bool turn);
uint64_t bishopAttacks(Board *board, bool turn);
uint64_t rookAttacks(Board *board, bool turn);
uint64_t queenAttacks(Board *board, bool turn);
uint64_t kingAttacks(Board *board, bool turn);
void initSlidingAttacks();
